{$DOMAIN} {
  root * /usr/share/caddy
  encode gzip zstd

  # Proxy /api/* as-is (keep the /api prefix)
  @api path /api/*
  reverse_proxy @api api:3000

  # SPA fallback for everything else
  try_files {path} /index.html

  header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    Referrer-Policy "no-referrer-when-downgrade"
  }
}
